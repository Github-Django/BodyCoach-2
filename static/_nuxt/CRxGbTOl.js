import{d as ce,bO as me,ao as j,x as q,F as c,r as C,s as fe,bP as pe,G as S,aw as ve,aq as he,a7 as G,o as i,c as x,a as I,b as k,w as _,C as R,z as V,A as z,g as e,D as g,N as v,e as J,t as Y,M as _e,y as Q,Y as W,I as ge,J as be,f as ye,K as O,_ as we,k as Ce}from"./BcqZkZus.js";import{_ as xe,a as ke}from"./ChOUEfbg.js";const Ve={class:"relative flex w-full"},ze={class:"me-1 size-6 shrink-0 text-center"},Pe=ce({inheritAttrs:!1,__name:"AddonInputPhone",props:{modelValue:{default:""},country:{default:void 0},format:{default:"international"},height:{default:200},itemHeight:{default:47},icon:{default:"ph:phone"},size:{default:"md"},rounded:{default:"sm"},error:{type:[String,Boolean],default:!1},disabled:{type:Boolean}},emits:["update:modelValue","update:country","validation"],setup(X,{expose:Z,emit:ee}){const o=X,$=ee;me();const p=j(o,"modelValue",$,{passive:!0,defaultValue:""}),l=j(o,"country",$,{passive:!0,defaultValue:void 0}),b=q({}),te=c(()=>Object.values(b.value)),m=q([]),n=C(""),H=c(()=>{const t=m.value.length>0?m.value.map(a=>b.value[a]):te.value;return n.value?t.filter(a=>a.label.toLowerCase().includes(n.value.toLowerCase())||a.labelLocal.toLowerCase().includes(n.value.toLowerCase())||a.labelFa.toLowerCase().includes(n.value.toLowerCase())||a.code.toLowerCase().includes(n.value.toLowerCase())||a.callingCode.toLowerCase().includes(n.value.toLowerCase())):t}),d=c(()=>!l.value||!b.value?null:b.value[l.value.toUpperCase()]);let h,E;const f=C(""),A=C(),y=C(),B=C(),r=fe({valid:!1,touched:!1,error:""});Z({modelValue:p,country:l,validation:r,currentCountry:d,possibleCountries:m,filter:n,filterRef:y,dropdownRef:A,inputRef:B});const oe=c(()=>{const t=o.height,a=H.value.length,u=Math.max(1,a)*o.itemHeight;return Math.min(u,t)}),{list:M,containerProps:re,wrapperProps:ae,scrollTo:ne}=pe(H,{itemHeight:o.itemHeight});let N=!1;const L=(t,a=!0)=>{f.value=t??"",r.touched=a,m.value=[];try{le(t)}catch(u){r.valid=!1,r.error=u instanceof Error?u.message:"",$("validation",r)}finally{p.value=f.value}};function w(t){o.disabled||(l.value=t,L(f.value,r.touched),setTimeout(()=>{B.value?.el?.focus()},100))}function le(t){if(!E){N=!0;return}if(h=E(t,{defaultCountry:l.value?.toUpperCase()||d.value?.code}),!h)throw new Error("INVALID_FORMAT");const a=h.isPossible();if(m.value=h.getPossibleCountries(),m.value.length===0)throw new Error("NO_POSSIBLE_COUNTRIES");if((!l.value||l.value&&!m.value.includes(l.value))&&(l.value=m.value[0]),!a)throw new Error("PHONE_NUMBER_NOT_POSSIBLE");if(r.valid||(r.valid=!0,r.error="",$("validation",r)),o.format==="international"){f.value=h.formatInternational();return}f.value=h.formatNational()}S(n,()=>{ne(0)}),S(()=>o.modelValue,t=>{t!==f.value&&L(t,r.touched)},{immediate:!0});let T;S(y,()=>{y.value&&(clearTimeout(T),T=setTimeout(()=>{y.value?.el?.focus()},100))}),ve(()=>{clearTimeout(T)}),he(()=>{G(()=>import("./DgKRU1xF.js"),[],import.meta.url).then(({getPhoneCountries:t})=>{b.value=t()}),G(()=>import("./CKvFmKTK.js"),[],import.meta.url).then(({parsePhoneNumber:t})=>{E=t,N&&(N=!1,L(f.value,r.touched))})});const D=c(()=>{switch(o.size){case"sm":return"h-8";case"lg":return"h-12";case"md":default:return"h-10"}}),U=c(()=>{switch(o.size){case"sm":return"top-[1.58rem]";case"lg":return"top-[1.7rem]";case"md":default:return"top-[1.5rem]"}}),P=c(()=>{switch(o.size){case"lg":return"w-6";case"sm":case"md":default:return"w-4"}}),se=c(()=>{switch(o.size){case"lg":return"!ps-[5rem]";case"sm":case"md":default:return"!ps-[4.5rem]"}}),ue=c(()=>{switch(o.rounded){case"sm":return"[&_.nui-text-button]:rounded-s";case"md":return"[&_.nui-text-button]:rounded-s-md";case"lg":return"[&_.nui-text-button]:rounded-s-xl";case"full":return"[&_.nui-text-button]:rounded-s-full";case"none":return""}});return(t,a)=>{const u=we,F=Ce,K=xe,ie=ke;return i(),x("div",Ve,[I("div",{class:v(["absolute start-0 flex items-center",[e(D),t.$attrs.label&&!("label-float"in t.$attrs)?e(U):"top-0"]])},[k(ie,{ref_key:"dropdownRef",ref:A,variant:"text",rounded:o.rounded,size:"lg",class:v(["[&_.nui-text-button]:border-muted-200 text-muted-400 dark:[&_.nui-text-button]:border-muted-800 flex h-full [&_.nui-text-button]:relative [&_.nui-text-button]:z-10 [&_.nui-text-button]:size-full [&_.nui-text-button]:border-e [&_.nui-text-button]:pe-2 [&_.nui-text-button]:ps-4",e(ue)])},{label:_(()=>[R(t.$slots,"country-label",V(z({modelValue:e(p),country:e(l),validation:e(r),filter:e(n),currentCountry:e(d)})),()=>[e(d)?.icon?(i(),g(u,{key:0,name:e(d).icon,class:v(["-mt-0.5",e(P)])},{default:_(()=>[J(Y(e(d).code),1)]),_:1},8,["name","class"])):(i(),g(u,{key:1,name:o.icon,class:v(["-mt-0.5",[e(P),o.error?"text-danger-500":""]])},null,8,["name","class"]))])]),default:_(()=>[k(F,{ref_key:"filterRef",ref:y,modelValue:e(n),"onUpdate:modelValue":a[0]||(a[0]=s=>_e(n)?n.value=s:null),rounded:t.rounded==="full"?"lg":t.rounded,size:"sm",icon:"ph:magnifying-glass"},null,8,["modelValue","rounded"]),I("div",Q(e(re),{style:{height:`${e(oe)}px`},class:"nui-slimscroll !mt-2"}),[I("div",V(z(e(ae))),[e(M).length===0?(i(),x("div",{key:0,style:W({height:`${t.itemHeight}px`})},[R(t.$slots,"country-placeholder",V(z({modelValue:e(p),country:e(l),validation:e(r),filter:e(n),currentCountry:e(d),selectCountry:w})),()=>[k(K,{title:"هیچ نتیجه‌ای یافت نشد",text:"سعی کنید با نام کشور یا کد جستجو کنید",rounded:o.rounded==="full"?"lg":o.rounded},null,8,["rounded"])])],4)):(i(!0),x(ge,{key:1},be(e(M),({data:s})=>(i(),x("div",{key:s?.code,style:W({height:`${t.itemHeight}px`})},[R(t.$slots,"country-item",V(z({item:s,modelValue:e(p),country:e(l),validation:e(r),filter:e(n),currentCountry:e(d),selectCountry:w})),()=>[k(K,{title:s?.labelFa,text:`+${s?.callingCode}`,tabindex:0,rounded:o.rounded==="full"?"lg":o.rounded,onClick:de=>w(s?.code),onKeyboard:ye(de=>w(s?.code),["prevent"])},{start:_(()=>[I("span",ze,[s?.icon?(i(),g(u,{key:0,name:s.icon,class:"size-6"},{default:_(()=>[J(Y(s.code),1)]),_:2},1032,["name"])):O("",!0)])]),end:_(()=>[e(l)===s?.code?(i(),g(u,{key:0,name:"ph:check",class:"text-success-500 size-4 shrink-0"})):O("",!0)]),_:2},1032,["title","text","rounded","onClick","onKeyboard"])])],4))),128))],16)],16)]),_:3},8,["rounded","class"])],2),k(F,Q({ref_key:"inputRef",ref:B,"model-value":e(f),type:"tel",autocomplete:"tel",size:o.size,error:o.error,disabled:o.disabled,rounded:o.rounded,classes:{wrapper:"relative grow [&_.nui-input-placeload]:ms-16",input:`${e(se)} !pe-8`,icon:"!w-16"}},t.$attrs,{"onUpdate:modelValue":a[1]||(a[1]=s=>{L(String(s))})}),null,16,["model-value","size","error","disabled","rounded","classes"]),R(t.$slots,"action",V(z({modelValue:e(p),country:e(l),validation:e(r),filter:e(n),currentCountry:e(d),selectCountry:w})),()=>[e(r).touched&&e(p)?(i(),x("div",{key:0,class:v(["border-muted-200 dark:border-muted-800 absolute end-0 z-[1] flex items-center pe-3",[e(D),t.$attrs.label&&!("label-float"in t.$attrs)?e(U):"top-0"]])},[e(r).valid?(i(),g(u,{key:0,name:"ph:check",class:v(["text-success-500 shrink-0",e(P)])},null,8,["class"])):(i(),g(u,{key:1,name:"ph:x",class:v(["text-danger-500 -mt-0.5",e(P)])},null,8,["class"]))],2)):O("",!0)])])}}});export{Pe as _};
