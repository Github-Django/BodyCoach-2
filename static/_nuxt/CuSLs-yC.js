import{F as x,g as W,x as fe,G as N,b9 as oe,a$ as pe,d as j,r as D,aC as U,s as he,aG as S,aD as me,ag as se,aH as be,aI as Z,R as te,a3 as G,aJ as ge,aK as xe,aL as Se,aM as q,aN as le,I as Oe,aO as J,aZ as ye,aQ as Q,a8 as Y,aP as Ie,ai as ue,aw as Ce,$ as B,b1 as Re,aR as Te,aS as _,aT as F,ba as ne,bb as ie,bc as Ee}from"./BcqZkZus.js";import{d as we,e as Me}from"./CYRu1j5R.js";import{s as ze}from"./C_HXzHsg.js";import{c as P,f as ae,u as Pe}from"./B3PT0ydx.js";import{i as $e}from"./DY2N-qsS.js";function K(o,d,e){let n=e.initialDeps??[],t;return()=>{var a,i,l,v;let h;e.key&&((a=e.debug)!=null&&a.call(e))&&(h=Date.now());const f=o();if(!(f.length!==n.length||f.some((R,w)=>n[w]!==R)))return t;n=f;let C;if(e.key&&((i=e.debug)!=null&&i.call(e))&&(C=Date.now()),t=d(...f),e.key&&((l=e.debug)!=null&&l.call(e))){const R=Math.round((Date.now()-h)*100)/100,w=Math.round((Date.now()-C)*100)/100,$=w/16,V=(m,O)=>{for(m=String(m);m.length<O;)m=" "+m;return m};console.info(`%c⏱ ${V(w,5)} /${V(R,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*$,120))}deg 100% 31%);`,e?.key)}return(v=e?.onChange)==null||v.call(e,t),t}}function ee(o,d){if(o===void 0)throw new Error(`Unexpected undefined${d?`: ${d}`:""}`);return o}const ke=(o,d)=>Math.abs(o-d)<1,De=o=>o,Fe=o=>{const d=Math.max(o.startIndex-o.overscan,0),e=Math.min(o.endIndex+o.overscan,o.count-1),n=[];for(let t=d;t<=e;t++)n.push(t);return n},Ve=(o,d)=>{const e=o.scrollElement;if(!e)return;const n=a=>{const{width:i,height:l}=a;d({width:Math.round(i),height:Math.round(l)})};if(n(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const t=new ResizeObserver(a=>{const i=a[0];if(i?.borderBoxSize){const l=i.borderBoxSize[0];if(l){n({width:l.inlineSize,height:l.blockSize});return}}n(e.getBoundingClientRect())});return t.observe(e,{box:"border-box"}),()=>{t.unobserve(e)}},Ae=(o,d)=>{const e=o.scrollElement;if(!e)return;const n=()=>{d(e[o.options.horizontal?"scrollLeft":"scrollTop"])};return n(),e.addEventListener("scroll",n,{passive:!0}),()=>{e.removeEventListener("scroll",n)}},_e=(o,d,e)=>{if(d?.borderBoxSize){const n=d.borderBoxSize[0];if(n)return Math.round(n[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(o.getBoundingClientRect()[e.options.horizontal?"width":"height"])},Be=(o,{adjustments:d=0,behavior:e},n)=>{var t,a;const i=o+d;(a=(t=n.scrollElement)==null?void 0:t.scrollTo)==null||a.call(t,{[n.options.horizontal?"left":"top"]:i,behavior:e})};class Ne{constructor(d){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const n=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(t=>{t.forEach(a=>{this._measureElement(a.target,a)})}):null);return{disconnect:()=>{var t;return(t=n())==null?void 0:t.disconnect()},observe:t=>{var a;return(a=n())==null?void 0:a.observe(t,{box:"border-box"})},unobserve:t=>{var a;return(a=n())==null?void 0:a.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([n,t])=>{typeof t>"u"&&delete e[n]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:De,rangeExtractor:Fe,onChange:()=>{},measureElement:_e,initialRect:{width:0,height:0},scrollMargin:0,gap:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...e}},this.notify=e=>{var n,t;(t=(n=this.options).onChange)==null||t.call(n,this,e)},this.maybeNotify=K(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,n=>{this.scrollRect=n,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,n=>{this.scrollAdjustments=0,this.scrollOffset!==n&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<n?"forward":"backward",this.scrollOffset=n,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=K(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,n,t,a)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:n,scrollMargin:t,getItemKey:a}),{key:!1}),this.getFurthestMeasurement=(e,n)=>{const t=new Map,a=new Map;for(let i=n-1;i>=0;i--){const l=e[i];if(t.has(l.lane))continue;const v=a.get(l.lane);if(v==null||l.end>v.end?a.set(l.lane,l):l.end<v.end&&t.set(l.lane,!0),t.size===this.options.lanes)break}return a.size===this.options.lanes?Array.from(a.values()).sort((i,l)=>i.end===l.end?i.index-l.index:i.end-l.end)[0]:void 0},this.getMeasurements=K(()=>[this.memoOptions(),this.itemSizeCache],({count:e,paddingStart:n,scrollMargin:t,getItemKey:a},i)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,l);for(let h=l;h<e;h++){const f=a(h),p=this.options.lanes===1?v[h-1]:this.getFurthestMeasurement(v,h),C=p?p.end+this.options.gap:n+t,R=i.get(f),w=typeof R=="number"?R:this.options.estimateSize(h),$=C+w,V=p?p.lane:h%this.options.lanes;v[h]={index:h,start:C,size:w,end:$,key:f,lane:V}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=K(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,n,t)=>this.range=e.length>0&&n>0?je({measurements:e,outerSize:n,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=K(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,n,t,a)=>n===null?[]:e({...n,overscan:t,count:a}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const n=this.options.indexAttribute,t=e.getAttribute(n);return t?parseInt(t,10):(console.warn(`Missing attribute name '${n}={index}' on measured element.`),-1)},this._measureElement=(e,n)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((l,v)=>{l===e&&(this.observer.unobserve(e),this.measureElementCache.delete(v))});return}const a=this.measureElementCache.get(t.key);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.measureElementCache.set(t.key,e));const i=this.options.measureElement(e,n,this);this.resizeItem(t,i)},this.resizeItem=(e,n)=>{const t=this.itemSizeCache.get(e.key)??e.size,a=n-t;a!==0&&(e.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,n)),this.notify(!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=K(()=>[this.getIndexes(),this.getMeasurements()],(e,n)=>{const t=[];for(let a=0,i=e.length;a<i;a++){const l=e[a],v=n[l];t.push(v)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const n=this.getMeasurements();return ee(n[re(0,n.length-1,t=>ee(n[t]).start,e)])},this.getOffsetForAlignment=(e,n)=>{const t=this.getSize();n==="auto"&&(e<=this.scrollOffset?n="start":e>=this.scrollOffset+t?n="end":n="start"),n==="start"?e=e:n==="end"?e=e-t:n==="center"&&(e=e-t/2);const a=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[a]:this.scrollElement[a]:0)-this.getSize();return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,n="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=ee(this.getMeasurements()[e]);if(n==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)n="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)n="start";else return[this.scrollOffset,n];const a=n==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,n),n]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:n="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,n),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:n="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[a,i]=this.getOffsetForIndex(e,n);this._scrollToOffset(a,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[v]=this.getOffsetForIndex(e,i);ke(v,this.scrollOffset)||this.scrollToIndex(e,{align:i,behavior:t})}else this.scrollToIndex(e,{align:i,behavior:t})}))},this.scrollBy=(e,{behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:n})},this.getTotalSize=()=>{var e;const n=this.getMeasurements();let t;return n.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=n[n.length-1])==null?void 0:e.end)??0:Math.max(...n.slice(-this.options.lanes).map(a=>a.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:n,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:n},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(d),this.scrollRect=this.options.initialRect,this.scrollOffset=typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.maybeNotify()}}const re=(o,d,e,n)=>{for(;o<=d;){const t=(o+d)/2|0,a=e(t);if(a<n)o=t+1;else if(a>n)d=t-1;else return t}return o>0?o-1:0};function je({measurements:o,outerSize:d,scrollOffset:e}){const n=o.length-1,a=re(0,n,l=>o[l].start,e);let i=a;for(;i<n&&o[i].end<e+d;)i++;return{startIndex:a,endIndex:i}}function Le(o){const d=new Ne(W(o)),e=fe(d),n=d._didMount();return N(()=>W(o).getScrollElement(),t=>{t&&d._willUpdate()},{immediate:!0}),N(()=>W(o),t=>{d.setOptions({...t,onChange:(a,i)=>{var l;oe(e),(l=t.onChange)==null||l.call(t,a,i)}}),d._willUpdate(),oe(e)},{immediate:!0}),pe(n),e}function Ke(o){return Le(x(()=>({observeElementRect:Ve,observeElementOffset:Ae,scrollToFn:Be,...W(o)})))}var Ue={};function qe(o,d){return o===d}var He=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(He||{}),Je=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(Je||{}),We=(o=>(o[o.Pointer=0]="Pointer",o[o.Focus=1]="Focus",o[o.Other=2]="Other",o))(We||{});let de=Symbol("ComboboxContext");function L(o){let d=ue(de,null);if(d===null){let e=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,L),e}return d}let ce=Symbol("VirtualContext"),Ze=j({name:"VirtualProvider",setup(o,{slots:d}){let e=L("VirtualProvider"),n=x(()=>{let l=S(e.optionsRef);if(!l)return{start:0,end:0};let v=window.getComputedStyle(l);return{start:parseFloat(v.paddingBlockStart||v.paddingTop),end:parseFloat(v.paddingBlockEnd||v.paddingBottom)}}),t=Ke(x(()=>({scrollPaddingStart:n.value.start,scrollPaddingEnd:n.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return S(e.optionsRef)},overscan:12}))),a=x(()=>{var l;return(l=e.virtual.value)==null?void 0:l.options}),i=D(0);return N([a],()=>{i.value+=1}),se(ce,e.virtual.value?t:null),()=>[G("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:l=>{if(l){if(typeof process<"u"&&Ue.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(l=>Re(d.default({option:e.virtual.value.options[l.index],open:e.comboboxState.value===0})[0],{key:`${i.value}-${l.index}`,"data-index":l.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":l.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${l.start}px)`,overflowAnchor:"none"}})))]}}),tt=j({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(o,{slots:d,attrs:e,emit:n}){let t=D(1),a=D(null),i=D(null),l=D(null),v=D(null),h=D({static:!1,hold:!1}),f=D([]),p=D(null),C=D(2),R=D(!1);function w(u=c=>c){let c=p.value!==null?f.value[p.value]:null,b=u(f.value.slice()),g=b.length>0&&b[0].dataRef.order.value!==null?b.sort((E,A)=>E.dataRef.order.value-A.dataRef.order.value):Te(b,E=>S(E.dataRef.domRef)),T=c?g.indexOf(c):null;return T===-1&&(T=null),{options:g,activeOptionIndex:T}}let $=x(()=>o.multiple?1:0),V=x(()=>o.nullable),[m,O]=we(x(()=>o.modelValue),u=>n("update:modelValue",u),x(()=>o.defaultValue)),k=x(()=>m.value===void 0?U($.value,{1:[],0:void 0}):m.value),r=null,I=null;function y(u){return U($.value,{0(){return O?.(u)},1:()=>{let c=_(s.value.value).slice(),b=_(u),g=c.findIndex(T=>s.compare(b,_(T)));return g===-1?c.push(b):c.splice(g,1),O?.(c)}})}let M=x(()=>{});N([M],([u],[c])=>{if(s.virtual.value&&u&&c&&p.value!==null){let b=u.indexOf(c[p.value]);b!==-1?p.value=b:p.value=null}});let s={comboboxState:t,value:k,mode:$,compare(u,c){if(typeof o.by=="string"){let b=o.by;return u?.[b]===c?.[b]}return o.by===null?qe(u,c):o.by(u,c)},calculateIndex(u){return s.virtual.value?o.by===null?s.virtual.value.options.indexOf(u):s.virtual.value.options.findIndex(c=>s.compare(c,u)):f.value.findIndex(c=>s.compare(c.dataRef.value,u))},defaultValue:x(()=>o.defaultValue),nullable:V,immediate:x(()=>!1),virtual:x(()=>null),inputRef:i,labelRef:a,buttonRef:l,optionsRef:v,disabled:x(()=>o.disabled),options:f,change(u){O(u)},activeOptionIndex:x(()=>{if(R.value&&p.value===null&&(s.virtual.value?s.virtual.value.options.length>0:f.value.length>0)){if(s.virtual.value){let c=s.virtual.value.options.findIndex(b=>{var g;return!((g=s.virtual.value)!=null&&g.disabled(b))});if(c!==-1)return c}let u=f.value.findIndex(c=>!c.dataRef.disabled);if(u!==-1)return u}return p.value}),activationTrigger:C,optionsPropsRef:h,closeCombobox(){R.value=!1,!o.disabled&&t.value!==1&&(t.value=1,p.value=null)},openCombobox(){if(R.value=!0,!o.disabled&&t.value!==0){if(s.value.value){let u=s.calculateIndex(s.value.value);u!==-1&&(p.value=u)}t.value=0}},setActivationTrigger(u){C.value=u},goToOption(u,c,b){R.value=!1,r!==null&&cancelAnimationFrame(r),r=requestAnimationFrame(()=>{if(o.disabled||v.value&&!h.value.static&&t.value===1)return;if(s.virtual.value){p.value=u===P.Specific?c:ae({focus:u},{resolveItems:()=>s.virtual.value.options,resolveActiveIndex:()=>{var E,A;return(A=(E=s.activeOptionIndex.value)!=null?E:s.virtual.value.options.findIndex(X=>{var H;return!((H=s.virtual.value)!=null&&H.disabled(X))}))!=null?A:null},resolveDisabled:E=>s.virtual.value.disabled(E),resolveId(){throw new Error("Function not implemented.")}}),C.value=b??2;return}let g=w();if(g.activeOptionIndex===null){let E=g.options.findIndex(A=>!A.dataRef.disabled);E!==-1&&(g.activeOptionIndex=E)}let T=u===P.Specific?c:ae({focus:u},{resolveItems:()=>g.options,resolveActiveIndex:()=>g.activeOptionIndex,resolveId:E=>E.id,resolveDisabled:E=>E.dataRef.disabled});p.value=T,C.value=b??2,f.value=g.options})},selectOption(u){let c=f.value.find(g=>g.id===u);if(!c)return;let{dataRef:b}=c;y(b.value)},selectActiveOption(){if(s.activeOptionIndex.value!==null){if(s.virtual.value)y(s.virtual.value.options[s.activeOptionIndex.value]);else{let{dataRef:u}=f.value[s.activeOptionIndex.value];y(u.value)}s.goToOption(P.Specific,s.activeOptionIndex.value)}},registerOption(u,c){let b=he({id:u,dataRef:c});if(s.virtual.value){f.value.push(b);return}I&&cancelAnimationFrame(I);let g=w(T=>(T.push(b),T));p.value===null&&s.isSelected(c.value.value)&&(g.activeOptionIndex=g.options.indexOf(b)),f.value=g.options,p.value=g.activeOptionIndex,C.value=2,g.options.some(T=>!S(T.dataRef.domRef))&&(I=requestAnimationFrame(()=>{let T=w();f.value=T.options,p.value=T.activeOptionIndex}))},unregisterOption(u,c){if(r!==null&&cancelAnimationFrame(r),c&&(R.value=!0),s.virtual.value){f.value=f.value.filter(g=>g.id!==u);return}let b=w(g=>{let T=g.findIndex(E=>E.id===u);return T!==-1&&g.splice(T,1),g});f.value=b.options,p.value=b.activeOptionIndex,C.value=2},isSelected(u){return U($.value,{0:()=>s.compare(_(s.value.value),_(u)),1:()=>_(s.value.value).some(c=>s.compare(_(c),_(u)))})},isActive(u){return p.value===s.calculateIndex(u)}};me([i,l,v],()=>s.closeCombobox(),x(()=>t.value===0)),se(de,s),be(x(()=>U(t.value,{0:Z.Open,1:Z.Closed})));let z=x(()=>{var u;return(u=S(i))==null?void 0:u.closest("form")});return te(()=>{N([z],()=>{if(!z.value||o.defaultValue===void 0)return;function u(){s.change(o.defaultValue)}return z.value.addEventListener("reset",u),()=>{var c;(c=z.value)==null||c.removeEventListener("reset",u)}},{immediate:!0})}),()=>{var u,c,b;let{name:g,disabled:T,form:E,...A}=o,X={open:t.value===0,disabled:T,activeIndex:s.activeOptionIndex.value,activeOption:s.activeOptionIndex.value===null?null:s.virtual.value?s.virtual.value.options[(u=s.activeOptionIndex.value)!=null?u:0]:(b=(c=s.options.value[s.activeOptionIndex.value])==null?void 0:c.dataRef.value)!=null?b:null,value:k.value};return G(Oe,[...g!=null&&k.value!=null?Me({[g]:k.value}).map(([H,ve])=>G(ge,xe({features:Se.Hidden,key:H,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:E,name:H,value:ve}))):[],q({theirProps:{...e,...le(A,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:X,slots:d,attrs:e,name:"Combobox"})])}}}),lt=j({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:null}},setup(o,{attrs:d,slots:e}){var n;let t=(n=o.id)!=null?n:`headlessui-combobox-label-${J()}`,a=L("ComboboxLabel");function i(){var l;(l=S(a.inputRef))==null||l.focus({preventScroll:!0})}return()=>{let l={open:a.comboboxState.value===0,disabled:a.disabled.value},{...v}=o,h={id:t,ref:a.labelRef,onClick:i};return q({ourProps:h,theirProps:v,slot:l,attrs:d,slots:e,name:"ComboboxLabel"})}}}),ot=j({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(o,{attrs:d,slots:e,expose:n}){var t;let a=(t=o.id)!=null?t:`headlessui-combobox-button-${J()}`,i=L("ComboboxButton");n({el:i.buttonRef,$el:i.buttonRef});function l(f){i.disabled.value||(i.comboboxState.value===0?i.closeCombobox():(f.preventDefault(),i.openCombobox()),B(()=>{var p;return(p=S(i.inputRef))==null?void 0:p.focus({preventScroll:!0})}))}function v(f){switch(f.key){case F.ArrowDown:f.preventDefault(),f.stopPropagation(),i.comboboxState.value===1&&i.openCombobox(),B(()=>{var p;return(p=i.inputRef.value)==null?void 0:p.focus({preventScroll:!0})});return;case F.ArrowUp:f.preventDefault(),f.stopPropagation(),i.comboboxState.value===1&&(i.openCombobox(),B(()=>{i.value.value||i.goToOption(P.Last)})),B(()=>{var p;return(p=i.inputRef.value)==null?void 0:p.focus({preventScroll:!0})});return;case F.Escape:if(i.comboboxState.value!==0)return;f.preventDefault(),i.optionsRef.value&&!i.optionsPropsRef.value.static&&f.stopPropagation(),i.closeCombobox(),B(()=>{var p;return(p=i.inputRef.value)==null?void 0:p.focus({preventScroll:!0})});return}}let h=ze(x(()=>({as:o.as,type:d.type})),i.buttonRef);return()=>{var f,p;let C={open:i.comboboxState.value===0,disabled:i.disabled.value,value:i.value.value},{...R}=o,w={ref:i.buttonRef,id:a,type:h.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(f=S(i.optionsRef))==null?void 0:f.id,"aria-expanded":i.comboboxState.value===0,"aria-labelledby":i.labelRef.value?[(p=S(i.labelRef))==null?void 0:p.id,a].join(" "):void 0,disabled:i.disabled.value===!0?!0:void 0,onKeydown:v,onClick:l};return q({ourProps:w,theirProps:R,slot:C,attrs:d,slots:e,name:"ComboboxButton"})}}}),nt=j({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:o=>!0},setup(o,{emit:d,attrs:e,slots:n,expose:t}){var a;let i=(a=o.id)!=null?a:`headlessui-combobox-input-${J()}`,l=L("ComboboxInput"),v=x(()=>ye(S(l.inputRef))),h={value:!1};t({el:l.inputRef,$el:l.inputRef});function f(){l.change(null);let r=S(l.optionsRef);r&&(r.scrollTop=0),l.goToOption(P.Nothing)}let p=x(()=>{var r;let I=l.value.value;return S(l.inputRef)?typeof o.displayValue<"u"&&I!==void 0?(r=o.displayValue(I))!=null?r:"":typeof I=="string"?I:"":""});te(()=>{N([p,l.comboboxState,v],([r,I],[y,M])=>{if(h.value)return;let s=S(l.inputRef);s&&((M===0&&I===1||r!==y)&&(s.value=r),requestAnimationFrame(()=>{var z;if(h.value||!s||((z=v.value)==null?void 0:z.activeElement)!==s)return;let{selectionStart:u,selectionEnd:c}=s;Math.abs((c??0)-(u??0))===0&&u===0&&s.setSelectionRange(s.value.length,s.value.length)}))},{immediate:!0}),N([l.comboboxState],([r],[I])=>{if(r===0&&I===1){if(h.value)return;let y=S(l.inputRef);if(!y)return;let M=y.value,{selectionStart:s,selectionEnd:z,selectionDirection:u}=y;y.value="",y.value=M,u!==null?y.setSelectionRange(s,z,u):y.setSelectionRange(s,z)}})});let C=D(!1);function R(){C.value=!0}function w(){ne().nextFrame(()=>{C.value=!1})}function $(r){switch(h.value=!0,r.key){case F.Enter:if(h.value=!1,l.comboboxState.value!==0||C.value)return;if(r.preventDefault(),r.stopPropagation(),l.activeOptionIndex.value===null){l.closeCombobox();return}l.selectActiveOption(),l.mode.value===0&&l.closeCombobox();break;case F.ArrowDown:return h.value=!1,r.preventDefault(),r.stopPropagation(),U(l.comboboxState.value,{0:()=>l.goToOption(P.Next),1:()=>l.openCombobox()});case F.ArrowUp:return h.value=!1,r.preventDefault(),r.stopPropagation(),U(l.comboboxState.value,{0:()=>l.goToOption(P.Previous),1:()=>{l.openCombobox(),B(()=>{l.value.value||l.goToOption(P.Last)})}});case F.Home:if(r.shiftKey)break;return h.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.First);case F.PageUp:return h.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.First);case F.End:if(r.shiftKey)break;return h.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.Last);case F.PageDown:return h.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.Last);case F.Escape:if(h.value=!1,l.comboboxState.value!==0)return;r.preventDefault(),l.optionsRef.value&&!l.optionsPropsRef.value.static&&r.stopPropagation(),l.nullable.value&&l.mode.value===0&&l.value.value===null&&f(),l.closeCombobox();break;case F.Tab:if(h.value=!1,l.comboboxState.value!==0)return;l.mode.value===0&&l.activationTrigger.value!==1&&l.selectActiveOption(),l.closeCombobox();break}}function V(r){d("change",r),l.nullable.value&&l.mode.value===0&&r.target.value===""&&f(),l.openCombobox()}function m(r){var I,y,M;let s=(I=r.relatedTarget)!=null?I:ie.find(z=>z!==r.currentTarget);if(h.value=!1,!((y=S(l.optionsRef))!=null&&y.contains(s))&&!((M=S(l.buttonRef))!=null&&M.contains(s))&&l.comboboxState.value===0)return r.preventDefault(),l.mode.value===0&&(l.nullable.value&&l.value.value===null?f():l.activationTrigger.value!==1&&l.selectActiveOption()),l.closeCombobox()}function O(r){var I,y,M;let s=(I=r.relatedTarget)!=null?I:ie.find(z=>z!==r.currentTarget);(y=S(l.buttonRef))!=null&&y.contains(s)||(M=S(l.optionsRef))!=null&&M.contains(s)||l.disabled.value||l.immediate.value&&l.comboboxState.value!==0&&(l.openCombobox(),ne().nextFrame(()=>{l.setActivationTrigger(1)}))}let k=x(()=>{var r,I,y,M;return(M=(y=(I=o.defaultValue)!=null?I:l.defaultValue.value!==void 0?(r=o.displayValue)==null?void 0:r.call(o,l.defaultValue.value):null)!=null?y:l.defaultValue.value)!=null?M:""});return()=>{var r,I,y,M,s,z,u;let c={open:l.comboboxState.value===0},{displayValue:b,onChange:g,...T}=o,E={"aria-controls":(r=l.optionsRef.value)==null?void 0:r.id,"aria-expanded":l.comboboxState.value===0,"aria-activedescendant":l.activeOptionIndex.value===null?void 0:l.virtual.value?(I=l.options.value.find(A=>!l.virtual.value.disabled(A.dataRef.value)&&l.compare(A.dataRef.value,l.virtual.value.options[l.activeOptionIndex.value])))==null?void 0:I.id:(y=l.options.value[l.activeOptionIndex.value])==null?void 0:y.id,"aria-labelledby":(z=(M=S(l.labelRef))==null?void 0:M.id)!=null?z:(s=S(l.buttonRef))==null?void 0:s.id,"aria-autocomplete":"list",id:i,onCompositionstart:R,onCompositionend:w,onKeydown:$,onInput:V,onFocus:O,onBlur:m,role:"combobox",type:(u=e.type)!=null?u:"text",tabIndex:0,ref:l.inputRef,defaultValue:k.value,disabled:l.disabled.value===!0?!0:void 0};return q({ourProps:E,theirProps:T,slot:c,attrs:e,slots:n,features:Q.RenderStrategy|Q.Static,name:"ComboboxInput"})}}}),it=j({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:d,slots:e,expose:n}){let t=L("ComboboxOptions"),a=`headlessui-combobox-options-${J()}`;n({el:t.optionsRef,$el:t.optionsRef}),Y(()=>{t.optionsPropsRef.value.static=o.static}),Y(()=>{t.optionsPropsRef.value.hold=o.hold});let i=Ie(),l=x(()=>i!==null?(i.value&Z.Open)===Z.Open:t.comboboxState.value===0);return $e({container:x(()=>S(t.optionsRef)),enabled:x(()=>t.comboboxState.value===0),accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}}),()=>{var v,h,f;let p={open:t.comboboxState.value===0},C={"aria-labelledby":(f=(v=S(t.labelRef))==null?void 0:v.id)!=null?f:(h=S(t.buttonRef))==null?void 0:h.id,id:a,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0},R=le(o,["hold"]);return q({ourProps:C,theirProps:R,slot:p,attrs:d,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[G(Ze,{},e.default)]}:e,features:Q.RenderStrategy|Q.Static,visible:l.value,name:"ComboboxOptions"})}}}),at=j({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(o,{slots:d,attrs:e,expose:n}){let t=L("ComboboxOption"),a=`headlessui-combobox-option-${J()}`,i=D(null);n({el:i,$el:i});let l=x(()=>{var m;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(o.value):t.activeOptionIndex.value===null?!1:((m=t.options.value[t.activeOptionIndex.value])==null?void 0:m.id)===a}),v=x(()=>t.isSelected(o.value)),h=ue(ce,null),f=x(()=>({disabled:o.disabled,value:o.value,domRef:i,order:x(()=>o.order)}));te(()=>t.registerOption(a,f)),Ce(()=>t.unregisterOption(a,l.value)),Y(()=>{let m=S(i);m&&h?.value.measureElement(m)}),Y(()=>{t.comboboxState.value===0&&l.value&&(t.virtual.value||t.activationTrigger.value!==0&&B(()=>{var m,O;return(O=(m=S(i))==null?void 0:m.scrollIntoView)==null?void 0:O.call(m,{block:"nearest"})}))});function p(m){var O;if(o.disabled||(O=t.virtual.value)!=null&&O.disabled(o.value))return m.preventDefault();t.selectOption(a),Ee()||requestAnimationFrame(()=>{var k;return(k=S(t.inputRef))==null?void 0:k.focus({preventScroll:!0})}),t.mode.value===0&&requestAnimationFrame(()=>t.closeCombobox())}function C(){var m;if(o.disabled||(m=t.virtual.value)!=null&&m.disabled(o.value))return t.goToOption(P.Nothing);let O=t.calculateIndex(o.value);t.goToOption(P.Specific,O)}let R=Pe();function w(m){R.update(m)}function $(m){var O;if(!R.wasMoved(m)||o.disabled||(O=t.virtual.value)!=null&&O.disabled(o.value)||l.value)return;let k=t.calculateIndex(o.value);t.goToOption(P.Specific,k,0)}function V(m){var O;R.wasMoved(m)&&(o.disabled||(O=t.virtual.value)!=null&&O.disabled(o.value)||l.value&&(t.optionsPropsRef.value.hold||t.goToOption(P.Nothing)))}return()=>{let{disabled:m}=o,O={active:l.value,selected:v.value,disabled:m},k={id:a,ref:i,role:"option",tabIndex:m===!0?void 0:-1,"aria-disabled":m===!0?!0:void 0,"aria-selected":v.value,disabled:void 0,onClick:p,onFocus:C,onPointerenter:w,onMouseenter:w,onPointermove:$,onMousemove:$,onPointerleave:V,onMouseleave:V},r=le(o,["order","value"]);return q({ourProps:k,theirProps:r,slot:O,attrs:e,slots:d,name:"ComboboxOption"})}}});export{tt as Z,at as a,lt as e,it as l,nt as o,ot as t};
