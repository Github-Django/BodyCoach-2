import{d as y,aj as B,aS as D,F as d,a3 as h,av as $,bD as f,bE as w,bF as N,bG as S,o as q,D as A,g as E}from"./BcqZkZus.js";import{p as _,k as F}from"./F6Cw1Rnw.js";import{f as I,h as L}from"./CayEAvHG.js";const g=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],b="default",x=/^@|^v-on:/,C=/^:|^v-bind:/,j=/^v-model/,V=["select","textarea","input"],K=Object.fromEntries(["p","a","blockquote","code","pre","code","em","h1","h2","h3","h4","h5","h6","hr","img","ul","ol","li","strong","table","thead","tbody","td","th","tr","script"].map(t=>[t,`prose-${t}`])),P=y({name:"MDCRenderer",props:{body:{type:Object,required:!0},data:{type:Object,default:()=>({})},tag:{type:[String,Boolean],default:void 0},prose:{type:Boolean,default:void 0},components:{type:Object,default:()=>({})}},async setup(t){const e=B()?.appContext?.app?.$nuxt,n=e?.$route||e?._route,{mdc:s}=e?.$config?.public||{},r={...s?.components?.prose&&t.prose!==!1?K:{},...s?.components?.map||{},...D(t.data?.mdc?.components||{}),...t.components},c=d(()=>{const i=(t.body?.children||[]).map(o=>o.tag||o.type).filter(o=>!g.includes(o));return Array.from(new Set(i)).sort().join(".")});return await Y(t.body,{tags:r}),{tags:r,contentKey:c,route:n}},render(t){const{tags:e,tag:n,body:s,data:r,contentKey:c,route:i}=t;if(!s)return null;const o={...r,tags:e,$route:i},a=n!==!1?v(n||o.component?.name||o.component||"div"):void 0,u=T(s,h,o,o);return a?h(a,{...o.component?.props,...this.$attrs,key:c},u):u.default?.()}});function W(t,e,n,s={}){if(t.type==="text")return e(f,t.value);if(t.type==="comment")return e(w,null,t.value);const r=t.tag,c=O(t,n.tags);if(t.tag==="binding")return k(t,e,n,s);const i=v(c);typeof i=="object"&&(i.tag=r);const o=z(t,n);return e(i,o,T(t,e,n,{...s,...o}))}function k(t,e,n,s={}){const r={...s,$document:n,$doc:n},c=/\.|\[(\d+)\]/,o=(t.props?.value.trim().split(c).filter(Boolean)).reduce((u,l)=>{if(u&&l in u)return typeof u[l]=="function"?u[l]():u[l]},r),a=t.props?.defaultValue;return e(f,o??a??"")}function T(t,e,n,s){const c=(t.children||[]).reduce((o,a)=>{if(!Q(a))return o[b].push(a),o;const u=M(a);return o[u]=o[u]||[],a.type==="element"&&o[u].push(...a.children||[]),o},{[b]:[]});return Object.entries(c).reduce((o,[a,u])=>(u.length&&(o[a]=()=>{const l=u.map(p=>W(p,e,n,s));return X(l)}),o),{})}function z(t,e){const{tag:n="",props:s={}}=t;return Object.keys(s).reduce(function(r,c){if(c==="__ignoreMap")return r;const i=s[c];if(j.test(c)&&!V.includes(n))return G(c,i,r,e);if(c==="v-bind")return U(c,i,r,e);if(x.test(c))return H(c,i,r,e);if(C.test(c))return J(c,i,r,e);const{attribute:o}=I(L,c);return Array.isArray(i)&&i.every(a=>typeof a=="string")?(r[o]=i.join(" "),r):(r[o]=i,r)},{})}function G(t,e,n,s){const r=p=>+p,c=p=>p.trim(),i=p=>p,o=t.replace(j,"").split(".").filter(p=>p).reduce((p,R)=>(p[R]=!0,p),{}),a="value",u=o.lazy?"change":"input",l=o.number?r:o.trim?c:i;return n[a]=m(e,s),n.on=n.on||{},n.on[u]=p=>s[e]=l(p),n}function U(t,e,n,s){const r=m(e,s);return n=Object.assign(n,r),n}function H(t,e,n,s){return t=t.replace(x,""),n.on=n.on||{},n.on[t]=()=>m(e,s),n}function J(t,e,n,s){return t=t.replace(C,""),n[t]=m(e,s),n}const v=t=>{if(!g.includes(t)&&!t?.render&&!t?.ssrRender){const e=$(_(t),!1);if(typeof e=="object")return e}return t};function m(t,e){const n=t.split(".").reduce((s,r)=>typeof s=="object"?s[r]:void 0,e);return typeof n>"u"?N(t):n}function M(t){let e="";for(const n of Object.keys(t.props||{}))if(!(!n.startsWith("#")&&!n.startsWith("v-slot:"))){e=n.split(/[:#]/,2)[1];break}return e||b}function Q(t){return t.tag==="template"}function X(t){const e=[];for(const n of t){const s=e[e.length-1];n.type===f&&s?.type===f?s.children=s.children+n.children:e.push(n)}return e}async function Y(t,e){if(!t)return;const n=Array.from(new Set(s(t,e)));await Promise.all(n.map(async r=>{if(r?.render||r?.ssrRender||r?.__ssrInlineRender)return;const c=v(r);c?.__asyncLoader&&!c.__asyncResolved&&await c.__asyncLoader()}));function s(r,c){const i=r.tag;if(r.type==="text"||i==="binding"||r.type==="comment")return[];const o=O(r,c.tags),a=[];r.type!=="root"&&!g.includes(o)&&a.push(o);for(const u of r.children||[])a.push(...s(u,c));return a}}function O(t,e){const n=t.tag;return!n||typeof t.props?.__ignoreMap<"u"?n:e[n]||e[_(n)]||e[F(t.tag)]||n}const nt=y({__name:"ContentRendererMarkdown",props:{value:{type:Object,required:!0},excerpt:{type:Boolean,default:!1},tag:{type:String,default:"div"},components:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})}},setup(t){const e=t,n=S().isEnabled(),s=d(()=>{let i=e.value.body||e.value;return e.excerpt&&e.value.excerpt&&(i=e.value.excerpt),i}),r=d(()=>{const{body:i,excerpt:o,...a}=e.value;return{...a,...e.data}}),c=d(()=>({...e.components,...r.value._components||{}}));return(i,o)=>{const a=P;return q(),A(a,{body:s.value,data:r.value,tag:t.tag,components:c.value,"data-content-id":E(n)?t.value._id:void 0},null,8,["body","data","tag","components","data-content-id"])}}});export{nt as _};
